var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,c=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))r.call(t,a)&&i(e,a,t[a]);return e},s=(e,n)=>t(e,a(n));import*as o from"react";import d,{useEffect as u,useMemo as m,useRef as p,useCallback as h,useState as E}from"react";import{L as f,c as v,a as b,i as N,d as g,b as y,e as x,f as I,g as T,h as w,j as C,k as O,l as P,m as _,n as R,o as k,p as A,u as D,q as L,D as S,H as V,r as M}from"./vendor.846954cc.js";var H,U,z,j,$,F,q,B;function W(e){return"INPUT"===e.type}function X(e){return"CONTAINER"===e.type}function J(e){return"TEXT"===e.type}function Y(e){return"FORM"===e.type}class G{constructor(e,t={}){this[H]=!0,this.control=e,this.id=t.id||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),this.data=v(e.defaultValues,t)}serialize(){return c({id:this.id,type:"element",control:this.control.id},this.data)}}H=f;class K extends G{constructor(e,t=e.defaultValues){super(e,t),this[U]=!0,this.direction=t.direction||e.defaultValues.direction,this.children=t.children||e.defaultValues.children||[],this.data=v(this.data,s(c({},t),{className:"",attributes:[]}))}get isRow(){return"row"===this.direction}serialize(){return s(c(c({},super.serialize()),this.data),{children:this.children.map((e=>e.serialize())),direction:this.direction,type:"CONTAINER"})}}U=f;class Q extends K{constructor(e,t){const{col:a}=e;if(!a)throw new Error("Column control doesn't exist?");super(a,s(c({},t),{direction:"row"})),this[f]=!0,this.data.className="formial-form"}serialize(){return s(c({},super.serialize()),{type:"FORM"})}}class Z extends G{constructor(e,t={}){super(e,t),this[z]=!0,this.data=v(e.defaultValues,t)}serialize(){return s(c(c({},super.serialize()),this.data),{type:"TEXT"})}}z=f;class ee extends G{constructor(e,t={}){super(e,t),this[j]=!0,this.data=v(e.defaultValues,t),this.control.hasOptions&&(this.data.options=this.data.options||[])}nested(e,t){return this.data[e].find((e=>e.id===t))}get placeholder(){return this.control.placeholder&&this.control.placeholder(this)||null}get optionPairs(){const{options:e}=this.data;return e?e.map((e=>[e.id,e.value])):[]}serialize(){return s(c(c({},super.serialize()),this.data),{type:"INPUT"})}}j=f;class te{constructor(e){this[$]=!0,this.name=e.name,this.id=e.id,this.icon=e.icon,this.placeholder=e.placeholder,this.hasOptions=e.hasOptions,this._defaultValues=v(this.defaultValues||{},e.defaultValues||{})}get defaultValues(){return c({},this._defaultValues)}createElement(){return new ee(this)}}function ae(e){return e instanceof K}function ne(e){return e instanceof ee}function le(e){return e instanceof Z}$=f;class re extends te{constructor(e){super(e),this[F]=!0,this._defaultValues=v(this._defaultValues||{},{children:[]})}createElement(){return new K(this)}}F=f;class ie extends te{constructor(e){super(e),this[q]=!0,this._defaultValues=v(this._defaultValues||{},{label:`${e.name} label`,className:"mb-2",classNames:{wrapper:this.wrapperClassName,label:"",input:"form-control"},attributes:[]})}get wrapperClassName(){switch(this.id){case"input":case"textarea":case"select":return"form-floating"}return"form-control"}get defaultValues(){return v(this._defaultValues,{name:`${this.id}-${Math.round(9999*Math.random())+1e3}`})}}q=f;class ce extends te{constructor(e){super(e),this[B]=!0,this._defaultValues=v(this._defaultValues||{},{tag:"para"===this.id?"p":"h3",text:"Some text…",className:""})}createElement(){return new Z(this)}}B=f;const se={registered:Object.create(null),register(e){e.forEach((e=>{this.registered[e.id]=e}))}},oe=(e,t)=>{const a=e[t.control];if(!a)return null;if(J(t))return new Z(a,t);if(W(t))return new ee(a,t);const n=[],l=t.children;return l&&l.forEach((t=>{const a=oe(e,t);a&&n.push(a)})),X(t)?new K(a,s(c({},t),{children:n})):new Q(e,s(c({},t),{children:n}))},de=o.createContext(null),ue=()=>o.useContext(de),me=()=>ue().store;de.displayName="StoreContext";const pe=(e,t)=>{if(e.id===t)return[e];if(ae(e))for(let a=0;a<e.children.length;a++){const n=e.children[a],l=pe(n,t);if(l.length)return l.concat(e)}return[]};const he=b(((e,t)=>{switch(t.type){case"ADD_ELEMENT":return function(e,{id:t,containerId:a,destIndex:n,fromIndex:l,fromContainerId:r}){let i,c;const s=pe(e.form,a)[0];if(ae(s)){if(null!=l&&r){const t=pe(e.form,r)[0];if(!ae(t))return;c=t.children[l],t.children.splice(l,1),t===s&&l<n&&(n-=1)}else if(i=e.controls[t],!i)return void console.warn(`attempted to drop id ${t} but no control exists`);!c&&i&&(c=i.createElement()),c&&s.children.splice(n,0,c)}}(e,t);case"APPEND_ELEMENT":return void e.form.children.push(t.control.createElement());case"CLEAR":return void(e.form=new Q(e.controls));case"REPLACE_FORM":{let a=null;return Y(t.form)?a=oe(t.controls,t.form):t.form instanceof Q&&(a=t.form),void(a&&a instanceof Q&&(e.form=a))}case"DELETE_ELEMENT":{const a=pe(e.form,t.elementId),n=a[1];return void n.children.splice(n.children.indexOf(a[0]),1)}case"UPSERT_OPTION":{const a=pe(e.form,t.inputId)[0];if(!ne(a))return;const n=a.data[t.nested].find((e=>e.id===t.optionId));return void(n?n.value=t.value||"":a.data[t.nested].push({id:t.optionId,value:t.value||""}))}case"UPDATE_ELEMENT":{const a=pe(e.form,t.elementId)[0];return void Object.assign(a.data,t.patch)}case"EDIT_ELEMENT":{const a=pe(e.form,t.elementId);return void(e.editingId=a[0].id)}case"HIDE_EDIT":return void(e.editingId=void 0);case"REORDER_OPTION":{const a=pe(e.form,t.inputId)[0];if(!ne(a))return;const n=a.data[t.nested],l=n.findIndex((e=>e.id===t.optionId)),r=n[l];return a.data[t.nested].splice(l,1),t.index>l&&(t.index-=1),void a.data[t.nested].splice(t.index,0,r)}case"DELETE_OPTION":{const a=pe(e.form,t.inputId)[0];if(!ne(a))return;const n=a.nested(t.nested,t.id);if(n){const e=a.data[t.nested].indexOf(n);-1!==e&&a.data[t.nested].splice(e,1)}}}})),Ee=e=>{const t=Object.create(null);return t.controls=c({},se.registered),t.form=e?oe(t.controls,e):new Q(t.controls,e),t},fe=e=>{const[t,a]=(e=>o.useReducer(he,e,Ee))(e);return o.useMemo((()=>({store:t,dispatch:a})),[t])},ve=e=>d.createElement(N.Icon,s(c({},e),{icon:g})),be=e=>d.createElement(N.Icon,s(c({},e),{icon:y})),Ne=e=>d.createElement(N.Icon,s(c({},e),{icon:x})),ge=e=>d.createElement(N.Icon,s(c({},e),{icon:I})),ye=e=>d.createElement(N.Icon,s(c({},e),{icon:T})),xe=e=>d.createElement(N.Icon,s(c({},e),{icon:w})),Ie=e=>d.createElement(N.Icon,s(c({},e),{icon:C})),Te=e=>d.createElement(N.Icon,s(c({},e),{icon:O})),we=e=>d.createElement(N.Icon,s(c({},e),{icon:P})),Ce=e=>d.createElement(N.Icon,s(c({},e),{icon:_})),Oe=e=>d.createElement(N.Icon,s(c({},e),{icon:R})),Pe=e=>d.createElement(N.Icon,s(c({},e),{icon:k})),_e=(e,t)=>{const a=e.optionPairs;if(0===a.length)return t("","");const n=a.map((([e,a])=>o.createElement("label",{key:e},t(e,a),o.createElement("span",null,a))));return o.createElement("div",{className:A("choices",e.data.choicesLayout)},n)};se.register([new ce({id:"heading",name:"Heading",icon:o.createElement(ye,null),placeholder:e=>o.createElement(e.data.tag,e.data.text)}),new ce({id:"para",name:"Paragraph",icon:o.createElement(xe,null),placeholder:e=>o.createElement("p",null,e.data.text)}),new ie({id:"input",name:"Text Input",icon:o.createElement(be,null),placeholder:()=>o.createElement("input",{type:"text",className:"form-control",readOnly:!0})}),new ie({id:"textarea",name:"Text Area",icon:o.createElement(ge,null),placeholder:()=>o.createElement("textarea",{className:"form-control",readOnly:!0})}),new ie({id:"checkbox",name:"Checkboxes",icon:o.createElement(we,null),hasOptions:!0,defaultValues:{options:[],choicesLayout:"vertical"},placeholder:e=>_e(e,(e=>o.createElement("input",{type:"checkbox",name:`pv-${e}`,readOnly:!0})))}),new ie({id:"radio",name:"Radio Input",hasOptions:!0,icon:o.createElement(Te,null),defaultValues:{options:[],choicesLayout:"vertical"},placeholder:e=>_e(e,(t=>o.createElement("input",{key:t,type:"radio",name:`pv-${e.data.name}`,readOnly:!0})))}),new ie({id:"select",name:"Select",hasOptions:!0,icon:o.createElement(ve,null),defaultValues:{options:[]},placeholder(e){const t=e.optionPairs;return o.createElement("select",{name:`pv-${e.data.name}`},t.map((([e,t])=>o.createElement("option",{key:e,value:e},t))))}}),new re({id:"row",name:"Row",icon:o.createElement(Ne,null),defaultValues:{direction:"row"}}),new re({id:"col",name:"Column",icon:o.createElement(Ie,null),defaultValues:{direction:"column"}})]);const Re=({children:e})=>o.createElement("h4",{className:"title"},e),ke=({children:e})=>o.createElement("div",{className:"scrolling"},e),Ae=({children:e,className:t})=>o.createElement("div",{className:A("values",t)},e),De=({control:e})=>{const{id:t,name:a,icon:n}=e,{dispatch:l}=ue(),[{opacity:r},i]=D({item:{id:t,type:"control"},collect:e=>({opacity:e.isDragging()?.4:1})});return o.createElement("div",{ref:i,style:{opacity:r},className:A("control-label"),onClick:()=>{l({type:"APPEND_ELEMENT",control:e})}},n,o.createElement("span",null,a))},Le=()=>{const{editingId:e,controls:t}=me();return e?null:o.createElement("div",{className:"controls"},o.createElement(Re,null,"Elements"),o.createElement(ke,{className:"listing"},o.createElement("ul",null,Object.values(t).map((e=>o.createElement(De,{key:e.id,control:e}))))))};const Se={};function Ve(e,t,a){const n=m((()=>Array.isArray(e)?e:[e]),[e]),l=Object.assign({},Se,a),r=p(t),{target:i}=l;u((()=>{r.current=t}));const c=h((e=>{n.some((t=>e.key===t))&&r.current(e)}),[n]);u((()=>{if("undefined"!=typeof window){const e=i?i.current:window;return e&&e.addEventListener("keydown",c),()=>{e&&e.removeEventListener("keydown",c)}}}),[n,i,t])}const Me=Symbol("new"),He=Symbol("delete"),Ue=({input:e,nested:t,onComplete:a})=>{const n=ue(),l=p(null),r=()=>{var r;const i=null==(r=l.current)?void 0:r.value;i&&(n.dispatch({type:"UPSERT_OPTION",nested:t,inputId:e.id,optionId:i}),a(i))},i=()=>{n.dispatch({type:"DELETE_OPTION",inputId:e.id,nested:t,id:""}),a(He)};return Ve(["Enter","Escape","Tab"],(e=>{switch(e.key){case"Tab":e.preventDefault(),r();break;case"Enter":r();break;case"Escape":i(),a(He)}}),{target:l}),u((()=>{var e;null==(e=l.current)||e.focus()}),[]),d.createElement("label",null,d.createElement("input",{ref:l,defaultValue:""}),d.createElement("span",{className:"value"}),d.createElement("button",{className:"delete-btn",onClick:i},d.createElement(Oe,null)))},ze=({input:e,nested:t,focused:a,index:n,onComplete:l,option:r})=>{const i=ue(),c=p(null),[{opacity:s},o]=D({item:{id:r.id,index:n,type:"option"},collect:e=>({opacity:e.isDragging()?.4:1})}),m=()=>{var a;i.dispatch({type:"UPSERT_OPTION",inputId:e.id,nested:t,optionId:r.id,value:null==(a=c.current)?void 0:a.value})};return Ve(["Enter","Tab"],(e=>{e.preventDefault(),m(),l(r.id)}),{target:c}),u((()=>{var e;a&&(null==(e=c.current)||e.focus())}),[a]),d.createElement("label",{className:"input-option-label draggable",style:{opacity:s},ref:o},d.createElement("div",{className:"label"},r.id,":"),d.createElement("input",{ref:c,className:"value",value:r.value||"",onChange:m}),d.createElement("button",{className:"delete-btn",onClick:()=>{i.dispatch({type:"DELETE_OPTION",id:r.id,inputId:e.id,nested:t}),l(He)}},d.createElement(Oe,null)))},je=({input:e,nested:t,index:a})=>{const n=ue(),[{isHovered:l},r]=L({accept:"option",collect:e=>({isHovered:e.isOver()}),drop:l=>{const{id:r}=l;n.dispatch({type:"REORDER_OPTION",nested:t,inputId:e.id,optionId:r,index:a})}});return d.createElement("div",{ref:r,className:A("drop","drop-target",{"is-hovered":l})})},$e=({label:e,input:t,nested:a,ignore:n=[]})=>{const[l,r]=E("");let i=t.data[a];return i?(i=i.filter((e=>!n.includes(e.id))),d.createElement("fieldset",{className:"options"},d.createElement("legend",null,e,":"),d.createElement("div",{className:"controls"},d.createElement("button",{onClick:()=>r(Me),className:"add-attr"},"➕")),i.length?d.createElement("div",{className:"heading"},d.createElement("span",null,"ID"),d.createElement("span",null,"Value")):null,i.map(((e,n)=>d.createElement(d.Fragment,{key:e.id},d.createElement(je,{input:t,nested:a,index:n}),d.createElement(ze,{focused:l===e.id,nested:a,option:e,input:t,index:n,onComplete:e=>{e===He?r(""):n===i.length-1&&r(Me)}})))),d.createElement(je,{input:t,nested:a,index:i.length}),l===Me&&d.createElement(Ue,{nested:a,input:t,onComplete:e=>{r(e===He?"":e)}}))):null},Fe=["input","textarea","radio"],qe=({input:e})=>{var t;const a=ue();return Fe.includes(e.control.id)?d.createElement("label",null,d.createElement("span",null,"Required?"),d.createElement("input",{type:"checkbox",className:"value",checked:"true"===(null==(t=e.nested("attributes","required"))?void 0:t.value)||!1,onChange:({target:{checked:t}})=>{a.dispatch({type:"UPSERT_OPTION",inputId:e.id,nested:"attributes",optionId:"required",value:String(t)})}})):null},Be=({input:e})=>{var t;const a=ue();return"input"!==e.control.id?null:d.createElement("label",null,d.createElement("span",null,"Type:"),d.createElement("select",{name:"type",className:"value",value:(null==(t=e.nested("attributes","type"))?void 0:t.value)||"text",onChange:({target:{value:t}})=>a.dispatch({type:"UPSERT_OPTION",inputId:e.id,optionId:"type",nested:"attributes",value:t})},["text","number","email","tel","date"].map((e=>{return d.createElement("option",{key:e,value:e},(t=e).charAt(0).toUpperCase()+t.slice(1));var t}))))},We=({input:e})=>{const t=ue();return e.data.choicesLayout?d.createElement("label",null,d.createElement("span",null,"Choices Layout:"),d.createElement("select",{value:e.data.choicesLayout,className:"value",onChange:({target:{value:a}})=>t.dispatch({type:"UPDATE_ELEMENT",elementId:e.id,patch:{choicesLayout:a}})},d.createElement("option",{value:"vertical"},"Vertical"),d.createElement("option",{value:"horizontal"},"Horizontal"),d.createElement("option",{value:"two_column"},"Two Column"),d.createElement("option",{value:"three_column"},"Three Column"))):null},Xe=({input:e})=>{const t=ue(),{data:a}=e,n=a=>t.dispatch({type:"UPDATE_ELEMENT",elementId:e.id,patch:a});return d.createElement(Ae,{className:"input"},d.createElement(Re,null,"Edit ",e.control.name),d.createElement(ke,null,d.createElement("label",null,d.createElement("span",null,"Label:"),d.createElement("input",{className:"value",value:a.label||"",onChange:({target:{value:e}})=>n({label:e})})),d.createElement("label",null,d.createElement("span",null,"Name:"),d.createElement("input",{className:"value",value:a.name||"",onChange:({target:{value:e}})=>n({name:e})})),d.createElement(Be,{input:e}),d.createElement(qe,{input:e}),d.createElement("label",null,d.createElement("span",null,"Class:"),d.createElement("input",{className:"value",value:a.className||"",onChange:({target:{value:e}})=>n({className:e})})),d.createElement(We,{input:e}),d.createElement($e,{input:e,label:"Options",nested:"options"}),d.createElement("fieldset",null,d.createElement("legend",null,"Other Class Names:"),d.createElement("label",null,d.createElement("span",null,"Wrapper:"),d.createElement("input",{className:"value",value:a.classNames.wrapper||"",onChange:({target:{value:e}})=>{n({classNames:{wrapper:e}})}})),d.createElement("label",null,d.createElement("span",null,"Label:"),d.createElement("input",{className:"value",value:a.classNames.label||"",onChange:({target:{value:e}})=>{n({classNames:{label:e}})}})),d.createElement("label",null,d.createElement("span",null,"Input:"),d.createElement("input",{className:"value",value:a.classNames.input||"",onChange:({target:{value:e}})=>{n({classNames:{input:e}})}}))),d.createElement($e,{input:e,label:"Attributes",nested:"attributes",ignore:["required","type"]})))},Je=({container:e})=>{const t=ue(),{data:a}=e;return d.createElement(Ae,{className:"container"},d.createElement(Re,null,"Edit ",e.control.name," container"),d.createElement("label",null,d.createElement("span",null,"Class:"),d.createElement("input",{className:"value",value:a.className||"",onChange:({target:{value:a}})=>{return n={className:a},t.dispatch({type:"UPDATE_ELEMENT",elementId:e.id,patch:n});var n}})))},Ye=({txt:e,onChange:t})=>"heading"!==e.control.id?null:d.createElement("label",null,d.createElement("span",null,"Size:"),d.createElement("select",{value:e.data.tag,onChange:e=>t(e.target.value)},d.createElement("option",{value:"h1"},"Heading 1"),d.createElement("option",{value:"h2"},"Heading 2"),d.createElement("option",{value:"h3"},"Heading 3"),d.createElement("option",{value:"h4"},"Heading 4"),d.createElement("option",{value:"h5"},"Heading 5"),d.createElement("option",{value:"h6"},"Heading 6"))),Ge=({control:e})=>{const t=ue(),{data:a}=e,n=a=>t.dispatch({type:"UPDATE_ELEMENT",elementId:e.id,patch:a});return d.createElement(Ae,{className:"text"},d.createElement(Re,null,"Edit text"),d.createElement("label",null,d.createElement("span",null,"Text:"),d.createElement("textarea",{id:e.id,value:a.text||"",onChange:({target:{value:e}})=>n({text:e})})),d.createElement(Ye,{txt:e,onChange:e=>n({tag:e})}),d.createElement("label",null,d.createElement("span",null,"Class:"),d.createElement("input",{className:"value",value:a.className||"",onChange:({target:{value:e}})=>n({className:e})})))},Ke=({target:e})=>ae(e)?d.createElement(Je,{container:e}):ne(e)?d.createElement(Xe,{input:e}):le(e)?d.createElement(Ge,{control:e}):null,Qe=()=>{const e=(()=>{const e=me();if(e.editingId)return pe(e.form,e.editingId)[0]})(),t=ue(),a=p(null);var n,l;return u((()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&l(e)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[n=a,l=()=>{t.dispatch({type:"HIDE_EDIT"})}]),e?d.createElement("div",{ref:a,className:"edit-panel"},d.createElement(Ke,{target:e})):null},Ze=()=>o.createElement("div",{className:"sidebar"},o.createElement(Le,null),o.createElement(Qe,null)),et=({index:e,container:t})=>{const a=ue(),[{isHovered:n},l]=L({accept:"control",collect:e=>({isHovered:e.isOver()}),drop:n=>{const{id:l,fromIndex:r,fromContainer:i}=n;a.dispatch({type:"ADD_ELEMENT",id:l,destIndex:e,containerId:t.id,fromIndex:r,fromContainerId:null==i?void 0:i.id})}});return{isHovered:n,dropRef:l}},tt=e=>{const{isHovered:t,dropRef:a}=et(e);return o.createElement("div",{ref:a,className:A("drop","horizontal",{"is-hovered":t})})},at=e=>{const{isHovered:t,dropRef:a}=et(e);return o.createElement("div",{ref:a,className:A("drop","vertical","container-drop",{"is-hovered":t})})},nt=({target:e,container:t,drag:a,displayEdit:n})=>{const l=ue();return o.createElement("div",{className:A("controls",{container:ae(e)})},o.createElement("span",null,e.control.name),o.createElement("button",{className:"trash",onClick:a=>{a.stopPropagation(),l.dispatch({type:"DELETE_ELEMENT",elementId:e.id,containerId:t.id})}},o.createElement(Oe,null)),n&&o.createElement("button",{onClick:()=>l.dispatch({type:"EDIT_ELEMENT",elementId:e.id})},o.createElement(Pe,null)),a&&o.createElement("button",{className:"move",ref:a},o.createElement(Ce,null)))},lt=({index:e,input:t,container:a})=>{const[{opacity:n},l]=D({item:{id:t.id,fromIndex:e,fromContainer:a,type:"control"},collect:e=>({opacity:e.isDragging()?.4:1})}),r=ue();return o.createElement("div",{ref:l,style:{opacity:n},className:A("element-preview",t.control.id,{"is-editing":r.store.editingId===t.id}),onClick:()=>r.dispatch({type:"EDIT_ELEMENT",elementId:t.id})},o.createElement(nt,{displayEdit:!1,target:t,container:a}),o.createElement("div",{className:"control-preview"},o.createElement("span",{className:"label"},t.data.label),t.placeholder))},rt=({index:e,control:t,container:a})=>{const n=ue(),[{opacity:l},r]=D({item:{id:t.id,fromIndex:e,fromContainer:a,type:"control"},collect:e=>({opacity:e.isDragging()?.4:1})}),i=o.createElement(t.data.tag,{},t.data.text);return o.createElement("div",{style:{opacity:l},ref:r,onClick:()=>n.dispatch({type:"EDIT_ELEMENT",elementId:t.id}),className:A("element-preview",t.control.id,{"is-editing":n.store.editingId===t.id})},o.createElement(nt,{displayEdit:!0,target:t,container:a}),o.createElement("div",{className:"control-preview"},i))},it=({parent:e,container:t,index:a})=>{const[{opacity:n},l,r]=D({item:{id:t.id,fromIndex:a,fromContainer:e,type:"control"},collect:e=>({opacity:e.isDragging()?.4:1})}),i=t.isRow?tt:at;return o.createElement("div",{ref:r,style:{opacity:n},className:A("element-preview","container",`container-${t.direction}`,{empty:0===t.children.length})},o.createElement(i,{container:t,index:0}),o.createElement(nt,{displayEdit:!0,target:t,container:e,drag:l}),t.children.map(((e,a)=>o.createElement(o.Fragment,{key:a},o.createElement(ct,{index:a,container:t,el:e}),o.createElement(i,{container:t,index:a+1})))))},ct=({el:e,index:t,container:a})=>ae(e)?o.createElement(it,{parent:a,container:e,index:t}):le(e)?o.createElement(rt,{control:e,container:a,index:t}):ne(e)?o.createElement(lt,{input:e,container:a,index:t}):null,st=()=>{const{form:e}=me(),[{isHovered:t},a]=L({accept:"control",collect:e=>({isHovered:e.isOver()}),canDrop:()=>!1});return o.createElement("div",{ref:a,className:A("form-elements",{isHovered:t})},o.createElement(tt,{container:e,index:0}),e.children.map(((t,a)=>o.createElement(o.Fragment,{key:a},o.createElement(ct,{index:a,container:e,el:t}),o.createElement(tt,{container:e,index:a+1})))))},ot=()=>o.createElement("div",{className:"form-panel"},o.createElement(st,null)),dt=({className:e,formRef:t,defaultValue:a})=>{const n=fe(a);return o.useEffect((()=>(t&&(t.current={get form(){return n.store.form},clear(){n.dispatch({type:"CLEAR"})},update(e){n.dispatch({type:"REPLACE_FORM",form:e,controls:n.store.controls})}}),()=>{t&&(t.current=null)})),[t,n.store.form]),o.createElement(S,{backend:V},o.createElement(de.Provider,{value:n},o.createElement("div",{className:A("formial-editor",e)},o.createElement(ot,null),o.createElement(Ze,null))))};class ut{constructor(e,t){this.data=e,this.options=t}createElement(){return document.createElement("div")}get columnSmWidth(){return this.options.parent instanceof ht&&this.options.parent.isBSRow?Math.round(12/this.options.parent.children.length):0}render(e,t=!1){return this.el||(this.el=this.createElement()),this.setAttributes({"data-control":this.data.type,"data-id":this.data.id,class:A(this.data.className,{[`col-sm-${this.columnSmWidth}`]:0!==this.columnSmWidth})}),t||this.setDataAttributes(),this.el.parentElement!==e&&e.appendChild(this.el),this}setDataAttributes(e=this.el){e&&this.data.attributes&&this.data.attributes.forEach((t=>{t.id&&e.setAttribute(t.id,String(t.value))}))}setAttributes(e,t=this.el){t&&e&&Object.keys(e).forEach((a=>{a&&t.setAttribute(a,String(e[a]))}))}}class mt extends ut{constructor(e,t){super(e,t),this.data=e}createElement(){return document.createElement(this.data.tag)}render(e){return super.render(e),this.el.innerText=this.data.text,this}}class pt extends ut{constructor(e,t){super(e,t),this.data=e}render(e){if(super.render(e,!0),this.setAttributes({"data-type":this.data.control,class:A(this.data.className,{[`col-sm-${this.columnSmWidth}`]:0!==this.columnSmWidth})}),!this.input){const e=this[`_${this.data.control}`];if(e){const t=e.apply(this);this.input=t,this.el.appendChild(this.input)}}return this}get optionPairs(){const{options:e}=this.data;return e?e.map((e=>[e.id,e.value])):[]}createInput(e){const t=document.createElement("div");t.className=this.data.classNames.wrapper;const a={};"INPUT"==this.data.type&&(a.type="text");const n=this.data.attributes||[];for(let i=0;i<n.length;i++)a[n[i].id]=n[i].value;const l=document.createElement(e);this.setDataAttributes(),this.setAttributes(c({name:this.data.name,id:this.data.id,class:"form-control",placeholder:this.data.label},a),l),t.appendChild(l);const r=document.createElement("label");if(r.innerText=this.data.label,this.setAttributes({for:this.data.id},r),"true"===String(a.required)){const e=document.createElement("span");e.innerText="✱",this.setAttributes({class:"required-indicator"},e),r.appendChild(e)}return t.appendChild(r),t}_textarea(){return this.createInput("textarea")}_input(){return this.createInput("input")}renderOptions(e){const t=document.createElement("div");this.setDataAttributes(t),t.className=this.data.classNames.wrapper;const a=document.createElement("div");a.innerText=this.data.label,t.appendChild(a);const n=this.data.choicesLayout,l=Boolean(!n||"vertical"==n),r=document.createElement("div");return r.className=A("d-flex","flex-wrap",{"flex-column":l,"ml-2":!l}),this.optionPairs.forEach((([t,a])=>{const{id:i,inputType:c,name:s,value:o,label:d}=e(t,a),u=`${i}-${this.data.id}`,m=document.createElement("label");this.setAttributes({class:A("form-check",{"ml-2":l,"pr-2":!l,"col-4":"three_column"===n,"col-6":"two_column"===n})},m);const p=document.createElement("input");this.setAttributes({class:"form-check-input","data-id":i,type:c,name:s,value:o,id:u},p),m.appendChild(p);const h=document.createElement("span");this.setAttributes({className:"form-check-label"},h),h.innerText=d,m.appendChild(h),r.appendChild(m)})),t.appendChild(r),t}_radio(){return this.renderOptions(((e,t)=>({inputType:"radio",name:this.data.name,id:e,value:t,label:t})))}_checkbox(){return this.renderOptions(((e,t)=>({inputType:"checkbox",name:e,value:t,id:e,label:t})))}_select(){const e=document.createElement("div");e.className="form-floating";const t=document.createElement("select");this.setAttributes({name:this.data.name,class:"form-select",id:this.data.id},t),this.optionPairs.forEach((([e,a])=>{const n=document.createElement("option");this.setAttributes({value:e},n),n.innerText=a,t.appendChild(n)})),e.appendChild(t);const a=document.createElement("label");return this.setAttributes({for:this.data.id},a),a.innerText=this.data.label,e.appendChild(a),e}}class ht extends ut{constructor(e,t){super(e,t),this.data=e,this.children=e.children.map((e=>Et(e,{parent:this}))).filter(Boolean)}get isBSRow(){return"column"===this.data.direction}render(e){var t;return super.render(e),this.el.className=A(null==(t=this.el)?void 0:t.className,{row:this.isBSRow,"d-flex flex-column":!this.isBSRow,"formial-form":"FORM"==this.data.type}),this.children.forEach((e=>e.render(this.el))),this}}const Et=(e,t={})=>J(e)?new mt(e,t):X(e)||Y(e)?new ht(e,t):W(e)?new pt(e,t):new ut(e,t);const ft={id:"48be90c9-3a9a-4fc6-9626-242a30febc05",type:"FORM",control:"col",direction:"row",children:[{id:"d69b7300-312a-4b8b-9da9-b616e987b8b4",type:"TEXT",control:"heading",tag:"h3",text:"Hello World",className:""},{id:"9e2e85b9-b24e-4d51-b126-a7f5c579039a",type:"TEXT",control:"para",name:"para-9368",tag:"p",text:"Please, tell us a bit about yourself",className:""},{id:"91a1e96a-e603-4dd7-92fd-14b4090c4754",type:"CONTAINER",control:"col",name:"col-7258",direction:"column",children:[{id:"09f04ad7-b72b-481d-90c4-535bb5b1b632",type:"CONTAINER",control:"row",name:"row-1462",direction:"row",children:[{id:"e6b074bf-4c4d-447e-890a-bb52bc24aece",type:"INPUT",control:"input",name:"name",label:"Your name",className:"mb-2",classNames:{wrapper:"form-floating",label:"",input:"form-control"},attributes:[{id:"type",value:"text"},{id:"required",value:"true"}]},{id:"051dc23f-d3b6-4783-a45d-54f6f4801ba2",type:"INPUT",control:"input",name:"email",label:"Email",className:"mb-2",classNames:{wrapper:"form-floating",label:"",input:"form-control"},attributes:[{id:"required",value:"true"},{id:"type",value:"email"}]},{id:"11fa0234-0c92-4a2c-864e-668cd8580fd8",type:"INPUT",control:"textarea",name:"address",label:"Address",className:"mb-2",classNames:{wrapper:"form-floating",label:"",input:"form-control"},attributes:[]}],className:"",attributes:[]},{id:"05df9d75-a59f-4f44-99bb-c37bd17db17d",type:"CONTAINER",control:"row",name:"row-10995",direction:"row",children:[{id:"1d1b3a3d-88b0-4ca2-979b-4fb231c33f9a",type:"INPUT",control:"checkbox",name:"foods",options:[{id:"steak",value:"Steak"},{id:"tomatoe",value:"Tomato"},{id:"pinapple",value:"Pineapple"},{id:"spinach",value:"Spinach"},{id:"candy",value:"Candy"},{id:"broccoli ",value:"Broccoli"}],choicesLayout:"vertical",label:"Which foods do you like?",className:"mb-2",classNames:{wrapper:"form-control",label:"",input:"form-control"},attributes:[]},{id:"7a16f198-cac0-440e-93a8-3c0bc153184e",type:"INPUT",control:"radio",name:"cats",options:[{id:"1",value:"One"},{id:"2",value:"Two"},{id:"3",value:"Three"}],choicesLayout:"vertical",label:"How many Cats?",className:"mb-2",classNames:{wrapper:"form-control",label:"",input:"form-control"},attributes:[]},{id:"b8a55c2a-6044-4672-a384-74be779b8f95",type:"INPUT",control:"select",name:"number",options:[{id:"2",value:"2"},{id:"1",value:"one"},{id:"5",value:"5"},{id:"42",value:"forty two"}],label:"Pick a number",className:"mb-2",classNames:{wrapper:"form-floating",label:"",input:"form-control"},attributes:[]}],className:"",attributes:[]}],className:"",attributes:[]}],className:"formial-form",attributes:[]},vt=()=>{const e=o.useRef(null),t=o.useRef(null);return o.createElement("div",{id:"example-builder"},o.createElement("h3",null,"Formial Demo"),o.createElement("p",null,"This is an example of Formial editing and rendering forms.  The source code for this demo can be viewed in ",o.createElement("a",{href:"https://github.com/nathanstitt/formial/blob/main/demo/demo.tsx"},"demo/demo.tsx"),"."),o.createElement(dt,{formRef:e,defaultValue:ft}),o.createElement("hr",null),o.createElement("div",null,o.createElement("button",{onClick:()=>{if(!e.current)return;const a=e.current.form.serialize();console.log(JSON.stringify(a)),((e,t)=>{e.innerHTML="";const a=Et(t);a&&a.render(e)})(t.current,a),e.current.clear()}},"Render")),o.createElement("hr",null),o.createElement("div",{className:"mb-4",ref:t}))};M.exports.render(o.createElement(vt,null),document.getElementById("app-root"));
